# SUSDR 360 - Configuration Système
# Système Unifié de Surveillance, Détection et Réponse
# SAHANALYTICS - Fisher Ouattara

system:
  name: "SUSDR 360"
  version: "1.0.0"
  debug: false
  data_dir: "./data"
  log_level: "INFO"
  timezone: "Africa/Abidjan"

# Configuration de l'API REST
api:
  host: "0.0.0.0"
  port: 8000
  workers: 1
  reload: false
  cors_origins:
    - "http://localhost:3000"
    - "http://localhost:8080"
    - "http://127.0.0.1:3000"
    - "http://127.0.0.1:8080"
  
  # Authentification
  auth:
    secret_key: "susdr360-secret-key-change-in-production"
    algorithm: "HS256"
    access_token_expire_minutes: 30
    
  # Limites de taux
  rate_limiting:
    enabled: true
    requests_per_minute: 100
    burst_size: 20

# Configuration de l'interface web
web:
  host: "0.0.0.0"
  port: 8080
  static_dir: "./web"
  title: "SUSDR 360 - Cybersecurity Platform"

# Configuration du processeur d'événements
event_processor:
  buffer_size: 10000
  batch_size: 100
  processing_timeout: 30
  max_concurrent_events: 50
  
  # Filtres globaux
  filters:
    min_severity: 1  # 1=Low, 2=Medium, 3=High, 4=Critical
    blacklist_sources: []
    whitelist_sources: []
  
  # Enrichissement
  enrichment:
    geolocation: true
    dns_resolution: true
    threat_intelligence: true
    user_context: true

# Configuration du moteur de corrélation
correlation:
  buffer_size: 5000
  cleanup_interval: 300  # secondes
  max_contexts: 1000
  
  # Règles par défaut
  default_rules:
    brute_force:
      enabled: true
      threshold: 5
      time_window_minutes: 5
    
    lateral_movement:
      enabled: true
      threshold: 1
      time_window_minutes: 30
    
    data_exfiltration:
      enabled: true
      threshold: 10
      time_window_minutes: 60

# Configuration de la détection d'anomalies IA/ML
anomaly_detection:
  enabled: true
  contamination: 0.1
  n_estimators: 100
  max_training_samples: 10000
  model_save_interval: 3600  # secondes
  
  # Modèles par type d'événement
  models:
    network:
      algorithm: "isolation_forest"
      features: ["src_port", "dst_port", "bytes", "protocol"]
    
    authentication:
      algorithm: "isolation_forest"
      features: ["hour_of_day", "source_ip", "user_agent"]
    
    endpoint:
      algorithm: "dbscan"
      features: ["process_name", "file_path", "registry_key"]

# Configuration des agents de collecte
agents:
  # Agent Windows
  windows:
    enabled: true
    collection_interval: 30  # secondes
    lookback_minutes: 60
    max_events_per_batch: 100
    
    monitored_logs:
      - "Security"
      - "System"
      - "Application"
      - "Microsoft-Windows-Sysmon/Operational"
    
    event_filters:
      Security: [4624, 4625, 4634, 4647, 4648, 4672, 4688, 4689, 4698, 4720]
      System: [7034, 7035, 7036, 7040]
      Application: []
      "Microsoft-Windows-Sysmon/Operational": [1, 3, 7, 8, 11, 13]
  
  # Agent Syslog
  syslog:
    enabled: false
    host: "0.0.0.0"
    port: 514
    protocol: "udp"
    max_message_size: 8192
  
  # Agent réseau (PCAP)
  network:
    enabled: false
    interface: "eth0"
    capture_filter: "not port 22"
    max_packet_size: 65535
  
  # Agent fichiers de logs
  file_monitor:
    enabled: false
    paths:
      - "/var/log/auth.log"
      - "/var/log/syslog"
      - "/var/log/apache2/access.log"
    
    patterns:
      - "*.log"
      - "*.txt"

# Configuration du stockage
storage:
  # Base de données principale
  database:
    type: "sqlite"
    path: "./data/susdr360.db"
    pool_size: 10
    max_overflow: 20
  
  # Stockage des événements (Elasticsearch optionnel)
  events:
    type: "sqlite"  # ou "elasticsearch"
    retention_days: 90
    compression: true
    
    # Configuration Elasticsearch (si utilisé)
    elasticsearch:
      hosts: ["localhost:9200"]
      index_prefix: "susdr360"
      shards: 1
      replicas: 0
  
  # Stockage des fichiers
  files:
    base_path: "./data/files"
    max_file_size: "100MB"
    allowed_extensions: [".log", ".txt", ".json", ".xml"]

# Configuration Threat Intelligence
threat_intelligence:
  enabled: true
  
  # Sources OSINT
  sources:
    virustotal:
      enabled: false
      api_key: ""
      rate_limit: 4  # requêtes par minute
    
    abuseipdb:
      enabled: false
      api_key: ""
      rate_limit: 1000  # requêtes par jour
    
    shodan:
      enabled: false
      api_key: ""
    
    otx:
      enabled: false
      api_key: ""
    
    misp:
      enabled: false
      url: ""
      api_key: ""
      verify_ssl: true
  
  # Cache local
  cache:
    ttl: 3600  # secondes
    max_entries: 10000
  
  # IOCs locaux
  local_iocs:
    file_path: "./data/local_iocs.json"
    auto_reload: true

# Configuration des notifications
notifications:
  # Email
  email:
    enabled: false
    smtp_server: "localhost"
    smtp_port: 587
    use_tls: true
    username: ""
    password: ""
    from_address: "susdr360@sahanalytics.com"
    
    # Destinataires par sévérité
    recipients:
      critical: ["admin@sahanalytics.com"]
      high: ["soc@sahanalytics.com"]
      medium: ["analyst@sahanalytics.com"]
  
  # Webhook
  webhook:
    enabled: false
    url: ""
    timeout: 30
    headers:
      Content-Type: "application/json"
    
    # Template du message
    template: |
      {
        "title": "{{ incident.title }}",
        "severity": "{{ incident.severity }}",
        "description": "{{ incident.description }}",
        "timestamp": "{{ incident.created_at }}"
      }
  
  # Slack
  slack:
    enabled: false
    webhook_url: ""
    channel: "#security-alerts"
    username: "SUSDR360"
  
  # Microsoft Teams
  teams:
    enabled: false
    webhook_url: ""

# Configuration SOAR (Security Orchestration)
soar:
  enabled: false
  
  # Playbooks automatiques
  playbooks:
    auto_block_ip:
      enabled: false
      triggers: ["brute_force_detection"]
      actions:
        - type: "firewall_block"
          duration: 3600  # secondes
    
    quarantine_file:
      enabled: false
      triggers: ["malware_detection"]
      actions:
        - type: "file_quarantine"
        - type: "notify_admin"
  
  # Intégrations
  integrations:
    firewall:
      type: "pfsense"  # ou "fortinet", "checkpoint"
      host: ""
      username: ""
      password: ""
    
    antivirus:
      type: "symantec"  # ou "mcafee", "kaspersky"
      api_url: ""
      api_key: ""

# Configuration de monitoring et métriques
monitoring:
  # Métriques Prometheus
  prometheus:
    enabled: false
    port: 9090
    path: "/metrics"
  
  # Health checks
  health_checks:
    enabled: true
    interval: 60  # secondes
    
    checks:
      - name: "database"
        type: "database_connection"
      - name: "disk_space"
        type: "disk_usage"
        threshold: 90  # pourcentage
      - name: "memory"
        type: "memory_usage"
        threshold: 85  # pourcentage

# Configuration de sécurité
security:
  # Chiffrement
  encryption:
    algorithm: "AES-256-GCM"
    key_rotation_days: 90
  
  # Audit
  audit:
    enabled: true
    log_file: "./data/audit.log"
    log_api_calls: true
    log_admin_actions: true
  
  # Contrôle d'accès
  access_control:
    session_timeout: 3600  # secondes
    max_failed_attempts: 5
    lockout_duration: 900  # secondes
  
  # Validation des entrées
  input_validation:
    max_event_size: "1MB"
    sanitize_html: true
    validate_json: true

# Configuration de développement
development:
  debug: false
  auto_reload: false
  profiling: false
  
  # Données de test
  mock_data:
    enabled: false
    events_per_minute: 10
    incident_probability: 0.1

# Configuration de production
production:
  # Performance
  performance:
    max_workers: 4
    worker_connections: 1000
    keepalive_timeout: 65
  
  # Sécurité renforcée
  security:
    hide_server_header: true
    force_https: true
    hsts_max_age: 31536000
  
  # Logging
  logging:
    level: "WARNING"
    format: "json"
    file: "./logs/susdr360.log"
    max_size: "100MB"
    backup_count: 5
